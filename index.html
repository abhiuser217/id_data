<!DOCTYPE html>
<html>
<head>
  <title>Application Search & Edit</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    input, button {
      padding: 8px;
      margin: 6px 0;
      width: 100%;
      max-width: 400px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    #form-section {
      display: none;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <h2>üîç Search Application by ID</h2>
  <input type="text" id="appId" placeholder="Enter Application ID">
  <button onclick="searchData()">Search</button>
  <div id="message"></div>

  <div id="form-section">
    <h3>‚úèÔ∏è Edit & Save</h3>
    <form id="editForm" onsubmit="submitForm(event)">
      <label>Application ID</label>
      <input name="APPLICATION ID" readonly>

      <label>Name</label>
      <input name="Name">

      <label>Mobile</label>
      <input name="Mobile">

      <label>M/F</label>
      <input name="M/F">

      <label>Date of Birth</label>
      <input name="DoB" type="date">

      <label>Blood Group</label>
      <input name="BLOOD GRP">

      <label>Address</label>
      <input name="ADRESS">

      <label>Guardian Mobile</label>
      <input name="GUARDIAN MOBILE">

      <button type="submit">üíæ Save to EditedData</button>
    </form>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzN0awq2f_ADCoeNvk8f3K4Apfru43N3CBIl304BqYyz-KJI97a-S7C_GDye-9P7Rluxg/exec'; // Replace with your Web App URL

    async function searchData() {
      const appId = document.getElementById('appId').value.trim();
      const msgDiv = document.getElementById('message');
      const formSection = document.getElementById('form-section');
      formSection.style.display = 'none';
      msgDiv.textContent = 'Searching...';

      const res = await fetch(`${scriptURL}?id=${encodeURIComponent(appId)}`);
      const data = await res.json();

      if (data.error) {
        msgDiv.textContent = '‚ùå Application ID not found.';
        return;
      }

      msgDiv.textContent = '‚úÖ Record found. You can edit below.';
      populateForm(data);
      formSection.style.display = 'block';
    }

    function populateForm(data) {
      const form = document.forms['editForm'];
      for (let key in data) {
        if (form.elements[key]) {
          form.elements[key].value = data[key];
        }
      }
    }

    function submitForm(event) {
      event.preventDefault();
      const form = document.forms['editForm'];
      const record = {};

      for (let element of form.elements) {
        if (element.name) {
          record[element.name] = element.value;
        }
      }

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(record),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.text())
      .then(msg => {
        alert("‚úÖ " + msg);
        document.getElementById('form-section').style.display = 'none';
        document.getElementById('message').textContent = '';
      });
    }
  </script>
</body>
</html>
